
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Hackety hack hack</title>
  <meta name="author" content="Jens Ohlig">

  
  <meta name="description" content="Ja, war okay.
">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.johl.io/blog/page/2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Hackety hack hack" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
        
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */
</script>


  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Hackety hack hack</a></h1>
  
    <h2>Atypisches Nutzerverhalten mit Rat und Tat.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.johl.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/02/jahresruckblick-2014/">Jahresrückblick 2014</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2015-01-02T21:05:00+01:00" pubdate>Jan 2<span>nd</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ja, war okay.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/21/31c3/">Vollkommen subjektive Auswahl — was ich mir auf dem #31c3 ansehen werde (wenn ich dazu komme)</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-12-21T13:53:00+01:00" pubdate>Dec 21<span>st</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Der 31. <a href="https://de.wikipedia.org/wiki/Chaos_Communication_Congress">Chaos Communication Congress</a> naht. Das <a href="https://events.ccc.de/congress/2014/Fahrplan/">Programm</a> ist prall gefüllt mit wirklich hervorragenden Vorträgen und anderen Events. Aus Erfahrung kann ich sagen, dass es trotzdem schwierig ist, den Congress zum Anhören von Vorträgen zu planen, dafür passiert an allen Ecken einfach zuviel. Spätestens am zweiten Tag schmeisst man das sorgsam ausgearbeitete Programm über den Haufen und bleibt in einer Ecke kleben, wo verrückte Menschen gerade an etwas arbeiten, was unbeschreiblich ist und trotzdem hat man einen Congress erlebt, der unvergleichlich ist. Vielleicht ist es wichtiger, sich mit der <a href="https://github.com/MacLemon/CongressChecklist/blob/master/README.md">Checkliste</a> der mitzubringenden Sachen zu beschäftigen, als mit dem Programm. Da Vorträge aufgezeichnet werden, kann man sie später ja noch nachschauen — allerdings könnte das gleich zum nächsten Trugschluss werden: Wenn die &#8220;schau ich mir lieber in der Aufzeichnung an&#8221;-Liste zu lang wird, ist es dann auch wieder Dezember 2015, bis man sie durch hat.</p>

<p>That being said: Eine kleine Auswahl von Vorträgen, die ich in Erwägung ziehe, folgt. Große, für viele sozial wichtige Veranstaltungen (Jahresrückblicke etc.) habe ich erstmal nicht aufgeführt.</p>

<h1>Tag 1</h1>

<p><a href="https://events.ccc.de/congress/2014/Fahrplan/events/6571.html">Die Keynote</a> von <a href="https://de.wikipedia.org/wiki/Alec_Empire">Alec Empire</a> versuche ich mir mal anzusehen. Wird bestimmt hyperreal und noisy. Von Alec Empire stammte schon die Musik zum Trailer vom letzten Jahr.</p>

<p>Dann gehe ich in Saal 2, zu <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6443.html">Trustworthy secure modular operating system engineering</a> von hannes und David. Hannes träumt seit ein paar Jahrzehnten vom Ausstieg aus der Unix-Technologie weltweit und jetzt sieht es so aus, als könnte es was werden, mit einem Betriebsystem, dass die Schwächen von C hinter sich lässt, indem es konsequent in OCaml implementiert wird. Diesmal ist es kein wilder Traum, sondern tatsächlich etwas, was u.a. mit Unterstützung der Uni in Cambridge echten Wumms erzeigen könnte.</p>

<p>Danach folgt das <a href="https://de.wikipedia.org/wiki/Zentrum_f%C3%BCr_politische_Sch%C3%B6nheit">Zentrum für politische Schönheit</a>: <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6584.html">Mit Kunst die Gesellschaft hacken</a>, also die mit den Mauerkreuzen an der EU-Aussengrenze und der Belohnung von 25.000€ für die Verhaftung der Eigentümerfamilie der Firma Krauss-Maffei Wegmann.</p>

<p>Parallel dazu findet ein Vortrag statt, den ich dadurch erst später sehen kann: <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6447.html">Let’s build our own personalized open textile production line</a>.  Schade, denn Open Source auf andere Bereiche der Ökonomie übertragen ist ein richtig spannendes Thema.</p>

<p>Ganz, ganz dick im Kalender steht bei mit der Vortrag zu <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6559.html">Jugend hackt</a>, nicht nur, weil ich in den letzten beiden Jahren das Projekt als Mentor mitbegleitet haben, sondern auch, weil ich alle Vortragenden total toll finde.</p>

<p>Später am Abend werde ich vielleicht bei <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6154.html">Crypto Tales from the Trenches</a> reinschauen, wo u.a. Laura Poitras davon berichtet, wie sie sich als Journalistin im direkten Kontakt mit Edward Snowden vor Ausspähung versuchte zu schützen. Anschliessend wird ihr Film <a href="https://de.wikipedia.org/wiki/Citizenfour_(Film)">CITIZENFOUR</a> gezeigt.</p>

<h1>Tag 2</h1>

<p>Vermutlich werde ich in <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6162.html">Programming with dependent types in Idris</a> gehen, weil ich eine Schwäche für Forschung im Bereich Programmiersprachen habe (und wir das Thema im <a href="http://currybuch.de/">Curry-Buch</a> auch kurz anscheiden). Allerdings läuft parallel <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6344.html">Security Analysis of Estonia&#8217;s Internet Voting System</a>.  Hm, mal sehen.</p>

<p>Klar ist dann allerdings <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6582.html">Das Transparenzportal Hamburg</a>.  Mit dem Hamburger Transparenzgesetz hatte ich ja auch schon <a href="http://blog.johl.io/blog/2014/01/06/lampedusaanfrage/">Erfahrungen gemacht</a>.</p>

<p>Später dann: <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6156.html">Fernvale: An Open Hardware and Software Platform, Based on the (nominally) Closed-Source MT6260 SoC</a>, was ich hauptsächlich auf dem Zettel habe, weil der Open-Hardware-Aktivist <a href="https://en.wikipedia.org/wiki/Andrew_Huang">bunnie</a> vorträgt und ich sein Projekt zum offenen Laptop so spannend finde.</p>

<h1>Tag 3</h1>

<p>An Tag 3 tritt das <a href="https://www.c-base.org/projects/c-atre/">c-atre</a> auf, was ich mir an dem Tag zwischen Lampenfieber und Rumgerenne überhaupt ansehen kann, wird sich zeigen. Unser Stück zu Urheberrecht und Zeitreisen <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6543.html">The Time is Right</a> gibt es am Abend, davor ist aber noch reichlich Programm.</p>

<p><a href="https://events.ccc.de/congress/2014/Fahrplan/events/6350.html">Correcting copywrongs</a> von meiner <a href="https://de.wikipedia.org/wiki/Julia_Reda">Lieblings-Abgeordneten im EU-Parlament</a> ist gesetzt. Wird der Hammer.</p>

<p><a href="https://events.ccc.de/congress/2014/Fahrplan/events/6547.html">&#8220;Exploit&#8221; in theater</a> klingt nicht uninteressant und hat auch was mit Theater zu tun, wenn es klappt, dann schau ich mir das vielleicht an.</p>

<p><a href="https://events.ccc.de/congress/2014/Fahrplan/events/6366.html">IFG – Mit freundlichen Grüßen</a>, völlig angemessen in Saal 1, könnte ein Knüller werden. Letzter Jahr startete nach dem Congress-Vortrag von Stefan Wehrmeyer die Debatte um das <a href="https://fragdenstaat.de/presse/2014-01-21-bmi-mahnt-fragdenstaat-ab/">Zensurheberrecht</a>. Ich erwarte eine ähnliche Bombe dieses Jahr :)</p>

<p>Dann ist Theater. Parallel zu unserer Aufführung gibt es einen Vortrag zu <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6253.html">Computer und Informatik in Nordkorea</a>, den ich dann wohl als Aufzeichnung sehen werde.</p>

<h1>Tag 4</h1>

<p><a href="https://events.ccc.de/congress/2014/Fahrplan/events/6213.html">The rise and fall of Internet voting in Norway</a> klingt interessant, wenn ich um die Uhrzeit schon aufnahmefähig bin.</p>

<p><a href="https://events.ccc.de/congress/2014/Fahrplan/events/6214.html">Attribution revolution</a> ist für mich auch beruflich ein Must. Mal sehen, ob sich Ideen aus dem Vortrag für <a href="http://wikimania2014.wikimedia.org/wiki/Submissions/How_to_stay_out_of_jail_and_still_use_images_from_Wikimedia_Commons">ein Projekt bei uns</a> nutzen lassen.</p>

<p>Dann habe ich noch das <a href="https://events.ccc.de/congress/2014/Fahrplan/events/6562.html">Closing Event</a> auf dem Zettel. Und natürlich Party.</p>

<p>Wird das alles klappen? Ich fürchte nicht. Aber aufgeregt bin ich schon beim Durchsehen des Programms&#8230;</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/07/links/">Links, frische (und halbfrische) Links!</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-12-07T21:25:00+01:00" pubdate>Dec 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://www.theeuropeanlibrary.org/tel4/access/data/opendata/details?id=opendata">European Library released Linked Open Data for 82 million bibliographic records from 25 member libraries. All CC0.</a></li>
<li><a href="https://jakevdp.github.io/blog/2014/11/11/the-hipster-effect-interactive/">The Hipster Effect: An IPython Interactive Exploration</a></li>
<li><a href="http://spectrum.ieee.org/computing/networks/osi-the-internet-that-wasnt">OSI: The Internet That Wasn’t. How TCP/IP eclipsed the Open Systems Interconnection standards to become the global protocol for computer networking</a></li>
<li><a href="https://en.wikipedia.org/wiki/History_of_radio#Legal_issues_with_radio">„When radio was introduced in the 1920s many predicted the end of records. Radio was a free medium for the public to hear music for which they would normally pay. While some companies saw radio as a new avenue for promotion, others feared it would cut into profits from record sales and live performances. Many companies had their major stars sign agreements that they would not appear on radio.&#8221;</a></li>
<li><a href="http://rijksemotions.com/">Rijks Emotions is a student project from Hyper Island, using the Rijksmuseum and Sightcorp api, matching people&#8217;s emotions with their relatives that hang on the museum&#8217;s walls.</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/23/around-me/">Was gibt es hier zu sehen? Mediawiki APIs hacken</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-11-23T16:33:00+01:00" pubdate>Nov 23<span>rd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Chantek ist ein besonderer Orang-Utan. Im Yerkes Regional Primate Research Center geboren lernte er innerhalb eines Forschungsprojektes mittels der amerikanischen Gebärdensprache (ASL) mit Menschen zu kommunizieren und gesprochenes Englisch zu verstehen, Grundlagen des Umgangs mit Geld und Spiele. Mit fünfeinhalb Jahren wurde ihm der Stand eines etwa zweijährigen Kindes attestiert, wobei er in einigen Bereichen (z. B. Sprachverständnis und Werkzeugnutzung) die Fertigkeiten eines vierjährigen Kindes aufwies. Über Chantek gibt es <a href="http://de.wikipedia.org/wiki/Chantek">in der Wikipedia</a> noch mehr zu lesen, als ich hier zitiert und zusammengefasst habe.</p>

<p><a href="https://github.com/hay/chantek">Chantek</a> ist aber auch der Name eines Hacks, der auf dem <a href="http://www.mediawiki.org/wiki/Amsterdam_Hackathon_2014">Mediawiki Hackathon 2014 in Amsterdam</a> von <a href="http://www.haykranen.nl/">Hay Kranen</a> gebastelt wurde. Auf Niederländisch heisst &#8220;Api&#8221; auch <a href="http://nl.wikipedia.org/wiki/Apen">Affe</a>. Eine API, die menschliche Sprache (zumindest ein bisschen) versteht, ist gut geeignet, um nach dem sprechenden Affen Chantek benannt zu werden.</p>

<p>Über die Mediawiki API habe ich im letzten Blogbeitrag bereits <a href="http://blog.johl.io/blog/2014/11/17/mediawiki-api/">eine umfassende Einführung</a> geschrieben. Chantek vereinfacht diese API auf besonders schlanke Weise und macht die Unterhaltung ein bisschen angenehmer. Um Properties bei Wikidata abzufragen und Titel darzustellen, brauche ich bei der klassischen <a href="http://www.mediawiki.org/wiki/Wikibase/API">Mediawiki API zu Wikidata</a> typischerweise mehrere API-Calls. Bei Chantek kann ich zum Beispiel sagen, dass mich nur Abfrageergebnisse auf Deutsch interessieren und ich bekomme die Werte dann auch mit ihrer deutschen Bezeichnung zurück.</p>

<h3>Über die Grenzen der Same-Origin-Policy hinweg mit CORS</h3>

<p>Chantek ist eine Python-Anwendung, die die <a href="http://enable-cors.org/">CORS-Spezifikation</a> implementiert, um JavaScript-Anwendungen in Web-Anwendungen zu ermöglichen, Daten auszulesen und darzustellen. Normalerweise gibt es bei JavaScript im Browser die <a href="http://de.wikipedia.org/wiki/Same-Origin-Policy">Same-Origin-Policy</a>, die verhindert, dass Daten aus beliebigen (und damit potenziell unsicheren) Quellen einfach so nachgeladen werden können: Clientseitiges JavaScript kann nur auf Daten der Domain zugreifen, woher auch das JavaScript selbst geladen wurde. Bei API-Calls stellt sich diese Maßnahme als gelinde gesagt schwierig dar. Um diese Beschränkung zu umgehen, gibt es zum Beispiel <a href="http://de.wikipedia.org/wiki/JavaScript_Object_Notation#JSONP">JSONP</a>, das aber selbst nicht unproblematisch ist. CORS ist eine Möglichkeit, die Grenzen der Same-Origin-Policy zu überschreiten, die auch Authentifizierung und feinere Sicherheitsabstufungen beinhaltet und vom W3C spezifiziert wurde.</p>

<p>Leider ist CORS nicht in allen Browsern vorhanden. Wie man browserunhabhängig prüft, ob CORS zur Verfügung steht (bei den meisten modernen Browsern ist das der Fall), zeigt etwa <a href="http://www.html5rocks.com/en/tutorials/cors/">dieses Tutorial von Monsur Hossain</a> und der darin benutzte Code:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">createCORSRequest</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;withCredentials&quot;</span> <span class="k">in</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Check if the XMLHttpRequest object has a &quot;withCredentials&quot; property.</span>
</span><span class='line'>    <span class="c1">// &quot;withCredentials&quot; only exists on XMLHTTPRequest2 objects.</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">XDomainRequest</span> <span class="o">!=</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Otherwise, check if XDomainRequest.</span>
</span><span class='line'>    <span class="c1">// XDomainRequest only exists in IE, and is IE&#39;s way of making CORS requests.</span>
</span><span class='line'>    <span class="nx">xhr</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XDomainRequest</span><span class="p">();</span>
</span><span class='line'>    <span class="nx">xhr</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Otherwise, CORS is not supported by the browser.</span>
</span><span class='line'>    <span class="nx">xhr</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Zeig mir meine Umgebung, Wikidata!</h3>

<p>Mit Chantek (und CORS) wollte ich eine JavaScript-Webanwendung schreiben, die mir anzeigt, was es in Wikidata um mich herum an geogetaggten Wisssensgegenständen gibt. In Berlin (zumindest innerhalb des S-Bahn-Rings) ist das einiges — viele interessante Orte sinde nur ein paar Hundert Meter weit entfernt und haben einen Wikipedia-Artikel.  Auf dem Land müsste ich meine Anwendung vermutlich ein bisschen erweitern: ein Radius von 500m ist nicht besonders üppig für manche Gegenden. Auch, dass ich Wissensgegenstände nur auf Deutsch suche und Artikel in der deutschsprachigen Wikipedia dazu anzeige, könnte eine überarbeitete Version meiner Anwendung als Parameter änderbar machen.</p>

<p>Als kleiner, schneller Hack zwischendurch, aufgespielt auf einen Webserver, hat mir meine Anwendung aber durchaus Spaß bereitet. Mit dem Mobiltelefon kann ich so schauen, was Wikidata für meine Umgebung anzeigt.</p>

<p>Ein API-Call, um Dinge im meiner Umgebung zu finden, kann mit Chantek
etwa so aussehen:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">http</span><span class="o">:</span><span class="c1">//chantek.bykr.org/wikidata/query?q=around[625,52.205,0.119,15]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Hiermit frage ich Chantek (über die <a href="http://wdq.wmflabs.org/api_documentation.html">WikidataQuery-API</a>) nach Wikidata-Wissensgegenständen im Umkreis von 15km um Cambridge in England: der erste Parameter (625) bezieht sich auf den Planeten, für den die Koordinaten gelten (Erde), die nächsten zwei sind die Koordinaten von Cambridge und mit 15 gebe ich den Radius an. Auch Brüche sind bei der Angabe des Radius möglich, 0.5 ist also 500m.</p>

<p>Jetzt fehlen mir nur noch meine aktuellen Koordinaten. Moderne Browser unterstützen das HTML5-Feature Geolocation, mit der JavaScript-Bibliothek <a href="http://modernizr.com/">Modernizr</a> kann ich überprüfen, ob dieses Feature vorhanden ist. Da es Privatsphärenbedenken bei der Abfrage von Geokoordinaten gibt, muss der Browser bei der ersten Abfrage der Koordinaten des Standorts von einer neuen Seite die Benutzerin oder den Benutzer fragen, ob das so in Ordnung ist. Wenn zugestimmt wird, können wir die Koordinaten benutzen, eine Abfrage starten und bekommen eine Liste von Wikidata-Items zurück. Tatsächlich erzeugen wir zuerst einen CORS-Request und als Callback-Funktion geht es gleich in die nächste Abfrage, denn wir wollen ja für jedes Element der Liste einen Titel und eine Wikipedia-Seite haben. Das könnte zum Beispiel so aussehen:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">locate_me</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Check if we can do HTML5 geolocation</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">Modernizr</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>       <span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">lat</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">;</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">lon</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">;</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">chantek</span> <span class="o">=</span> <span class="s2">&quot;http://chantek.bykr.org/wikidata/&quot;</span><span class="p">;</span>
</span><span class='line'>          <span class="c1">// Query data around me</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">query</span> <span class="o">=</span> <span class="s2">&quot;query?q=around[625,&quot;</span> <span class="o">+</span> <span class="nx">lat</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">lon</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="s2">&quot;0.5]&amp;callback=?&quot;</span><span class="p">;</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">query_xhr</span> <span class="o">=</span> <span class="nx">createCORSRequest</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">chantek</span><span class="o">+</span><span class="nx">query</span><span class="p">);</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">query_xhr</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;CORS not supported&#39;</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>          <span class="nx">query_xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>            <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">query_xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
</span><span class='line'>            <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">(</span><span class="nx">response</span><span class="p">).</span><span class="nx">response</span><span class="p">;</span>
</span><span class='line'>            <span class="nx">$</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>              <span class="c1">// Call queried entities and display them</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">entity</span> <span class="o">=</span> <span class="s2">&quot;entity?q=Q&quot;</span><span class="o">+</span> <span class="nx">value</span> <span class="o">+</span> <span class="s2">&quot;&amp;lang=de&amp;callback=?&quot;</span><span class="p">;</span>
</span><span class='line'>              <span class="kd">var</span> <span class="nx">entity_xhr</span> <span class="o">=</span> <span class="nx">createCORSRequest</span><span class="p">(</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">chantek</span><span class="o">+</span><span class="nx">entity</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">entity_xhr</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>                <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">entity_xhr</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
</span><span class='line'>                <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">$</span><span class="p">.</span><span class="nx">parseJSON</span><span class="p">(</span><span class="nx">response</span><span class="p">).</span><span class="nx">response</span><span class="p">;</span>
</span><span class='line'>                <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#location-list&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span>
</span><span class='line'>                    <span class="s2">&quot;&lt;li&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s2">&quot;&lt;big&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s2">&quot;&lt;a href=&quot;</span> <span class="o">+</span> <span class="s2">&quot;\&quot;&quot;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="nx">data</span><span class="p">[</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]].</span><span class="nx">sitelinks</span><span class="p">.</span><span class="nx">de</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s2">&quot;\&quot;&gt;&quot;</span><span class="o">+</span>
</span><span class='line'>                    <span class="nx">data</span><span class="p">[</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">]].</span><span class="nx">labels</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s2">&quot;&lt;/a&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s2">&quot;&lt;/big&gt;&quot;</span> <span class="o">+</span>
</span><span class='line'>                    <span class="s2">&quot;&lt;/li&gt;&quot;</span>
</span><span class='line'>                <span class="p">);</span>
</span><span class='line'>              <span class="p">};</span>
</span><span class='line'>              <span class="nx">entity_xhr</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>                <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Error making the request&#39;</span><span class="p">);</span>
</span><span class='line'>              <span class="p">};</span>
</span><span class='line'>              <span class="nx">entity_xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span><span class='line'>            <span class="p">});</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>          <span class="nx">query_xhr</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Error making the request&#39;</span><span class="p">);</span>
</span><span class='line'>          <span class="p">};</span>
</span><span class='line'>          <span class="nx">query_xhr</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Geolocation not supported&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Der fertige Hack</h3>

<p>Mit ein bisschen UI und HTML drumherum habe ich diesen kleinen Hack unter <a href="http://www.johl.io/aroundme-wikidata/">http://www.johl.io/aroundme-wikidata/</a> ins Netz gestellt. Ich wünsche viel Spaß!</p>

<p>In der Nähe des U-Bahnhofs Eberswalder Straße in Berlin sieht das auf meinem Mobiltelefon etwa so aus:</p>

<p><img src="http://f.cl.ly/items/262K2m0k4531221t0g1R/aroundme-wikidata.png" width="300"></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/17/mediawiki-api/">Die Cola oder das Cola? Mediawiki APIs hacken</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-11-17T22:10:00+01:00" pubdate>Nov 17<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Die Web-API von Mediawiki (und damit von den meisten Wikimedia-Projekten) ist zwar nicht gerade versteckt, aber meiner Meinung nach viel zu unbekannt. In loser Folge werde ich ein paar Hacks mit APIs für verschiedene Projekte vorstellen, auch um dazu anzuregen, selbst mit der Infrastruktur zu spielen.</p>

<h3>Die Web-API von Mediawiki</h3>

<p>Mediawiki hat eine RESTful Web-API. Leider ist API im Mediawiki-Umfeld ein mehrfach belegtes Wort, so dass es auch eine API gibt, um eigene Erweiterungen in PHP zu schreiben; diese API meine ich in dem Fall nicht, sondern die Schnittstelle, mit der sich Daten und Inhalte per <code>HTTP</code> aus Mediawiki holen lassen.</p>

<p>Zunächst gibt es da einen Endpunkt. Bei den Wikimedia-Projekten liegt dieser unter <code>/w/api.php</code>, bei dem unten benutzten <code>Wiktionary</code> also unter <code>https://de.wiktionary.org/w/api.php</code>. Praktischerweise ist der Endpunkt für die API-Calls auch gleich eine URL zur Dokumentation. Einfach den Endpunkt im Browser eingeben es erscheint eine Seite, auf der die möglichen Calls verzeichnet sind und auch mit Beispielen erklärt werden.</p>

<p>Ein vollständiger API-Call könnte etwa so aussehen:</p>

<p><code>https://de.wiktionary.org/w/api.php?format=json&amp;action=query&amp;prop=revisions&amp;rvprop=content&amp;titles=Cola</code></p>

<p>Schauen wir uns den API-Call mal genauer an und zerlegen ihn in seine Einzelteile.</p>

<h4>Das Format für die Serialisierung</h4>

<p><code>format=json</code></p>

<p>Hiermit sagen wir dem Wikimedia-Web-Service, dass wir den Rückgabewert gern als <code>JSON</code> formatiert bekommen wollen. Alternativ können wir zur Anzeige im Webbrowser das auch schön formatiert mit dem Aufruf <code>format=jsonfm</code> bekommen – das ist manchmal für das Debugging übersichtlicher und hilfreicher. Die API unterstützt noch andere Ausgabeformate wie <code>WDDX</code>, <code>XML</code>, <code>YAML</code> und eine native PHP-Serialisierung, aber möglicherweise werde diese in Zukunft nicht mehr bedient. <code>JSON</code> wird stark präferiert und sollte wenn immer möglich benutzt werden.</p>

<h4>Die Action</h4>

<p><code>action=query</code></p>

<p>Die &#8220;Action&#8221;, also sozusagen das Verb, ist der eigentliche Befehl, der aufgerufen wird. Es gibt etliche solche Actions, die in der Mediawiki-API dokumentiert sind, Extensions können noch weitere Actions hinzufügen, die Actions zu Wikidata etwa beginnen mit &#8220;wb&#8221; für <a href="http://wikiba.se/">Wikibase</a>. Hier benutzen wir <code>query</code>zur Abfrage von Daten.</p>

<p>Die Action <code>query</code> ist selbst wieder umfangreich dokumentiert, wir
schauen uns hier ein paar beispielhafte Parameter an.</p>

<h4>Action-spezifische Parameter</h4>

<p><code>titles=Cola</code></p>

<p>Wir fragen hier die API nach den Daten einer Wiki-Seite mit dem Titel &#8220;Cola&#8221;. In der Abfrage werden Titel URL-kodiert, wenn der Titel also ein Leerzeichen enthält, wird dieses zu <code>%20</code>. Wenn mehrere Seiten gleichzeitig abgefragt werden können (und sollten) sie kombiniert werden, um nicht durch mehrere Abfragen hintereinander die Netzwerklast unnötig zu erhöhen: <code>titles=PageA|PageB|PageC</code></p>

<p><code>prop=revisions</code></p>

<p>Mit diesem Parameter können wir eine Revision der Seite angeben. Wenn wir keine weiteren Informationen zur Revision angeben bekommen wir die aktuelle Version der Seite.</p>

<p><code>rvprop=content</code></p>

<p>Mit diesem Parameter sagen wir der API, dass wir den Inhalt der Seite haben wollen. Hätten wir stattdessen zum Beispiel <code>rvprop=content|user</code> angegen, bekämen wir den Inhalt un den Benutzer, der die letzte Änderung vorgenommen hat.</p>

<p>Es gibt über die API und mögliche Parameter und Actions noch viel mehr zu sagen, aber als Beispiel reicht das erstmal. Die Dokumentation zur API ist noch viel umfangreicher. Ein guter Einstiegspunkt ist die <a href="https://www.mediawiki.org/wiki/API:Main_page">Dokumentation auf Mediawiki</a>, die ich hier teilweise übersetzt habe.</p>

<p>Eine gute Einführung in die API gibt es auch als Video:</p>

<iframe src="https://commons.wikimedia.org/wiki/File%3AThe_MediaWiki_Web_API_and_How_to_use_it_-_San_Francisco_Wikipedia_Hackathon_2012.ogv?embedplayer=yes" width="512" height="288" frameborder="0" ></iframe>


<div class="description mw-content-ltr en" dir="ltr" lang="en"  style="font-size: small;">Video from the <a href="//www.mediawiki.org/wiki/San_Francisco_Hackathon_2012" class="extiw" title="mw:San Francisco Hackathon 2012">San Francisco Hackathon 2012</a>: How to use the <a href="//www.mediawiki.org/wiki/API" class="extiw" title="mw:API">MediaWiki API</a>. Speaker is <a href="https://commons.wikimedia.org/w/index.php?title=User:Catrope&amp;action=edit&amp;redlink=1" class="new" title="User:Catrope (page does not exist)">Roan Kattouw</a>, facilitated by <a href="https://commons.wikimedia.org/wiki/User:Sumanah" title="User:Sumanah">Sumana Harihareswara</a>. <a class="external text" href="https://www.mediawiki.org/wiki/API/Tutorial">Tutorial reference includes useful links and instructions.</a></div>


<p></p>


<h3>Artikel von Substantiven mit <code>migrationsschatten.py</code> abfragen</h3>

<p>Als erstes Beispiel für eine Spielerei mit der API geht es um Zweifelsfragen der deutschen Sprache. Eine sehr gute Freundin von mir, beneidenswert bilingual aufgewachsen mit Deutsch und Englisch als Muttersprache, erzählte mir vor einiger Zeit davon, dass sie dann doch manchmal überrascht sei, welches grammatikalische Geschlecht und damit welchen Artikel ein Wort im Deutschen hat: <em>&#8220;<strong>Der</strong> Knoblauch? Ernsthaft?&#8221;</em>. Wie gesagt, es handelt sich bei ihr um eine Muttersprachlerin, aber diesen Einwand wischte sie schnell beiseite mit <em>&#8220;Ach, das ist eben mein Migrationsschatten&#8221;</em>.</p>

<p>Das Problem ist aber häufig genug, um sich hinzusetzen und ein kleines Programm zu schreiben, das Wiktionary nach dem korrekten Artikel befragt. Heisst es &#8220;der Laptop&#8221; oder &#8220;das Laptop&#8221;? Und was war mit der Werbung einer österreichischen Energydrink-Marke, die von &#8220;das Cola&#8221; sprach? Ist das korrekt?</p>

<p>Das Progrämmchen ist ein bisschen älter, aber ich habe es seitdem ein bisschen poliert und umgeschrieben. Die Freundin mit der Frage nach den Artikeln benutzt es nach eigener Aussage regelmäßig. Im Original ist es <a href="https://gist.github.com/johl/5515041">als gist auf Github</a> verfügbar, aber gehen wir das Programm doch mal der Reihe nach durch:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">json</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">re</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">urllib2</span>
</span></code></pre></td></tr></table></div></figure>


<p>Es beginnt mit ein paar Imports. Das Programm ist für Python 2.7 geschrieben, eine Portierung nach Python3 lasse ich mal als Aufgabe für die Leserin oder den Leser (<code>urllib2</code> und <code>json</code> bräuchten dafür Liebe, die über die automatische Portierung mit
<a href="https://docs.python.org/2/library/2to3.html">2to3</a> hinausgeht).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span class='line'>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&#39;Abfrage mit: </span><span class="si">%s</span><span class="s"> Substantiv&#39;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span class='line'><span class="n">substantiv</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>Wenn kein Substantiv angegeben ist, ist die ganze Sache auch schon vorbei, ansonsten nehmen wir an, dass der erste Kommandozeilenparameter das gesuchte Substantiv ist.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="k">try</span><span class="p">:</span>
</span><span class='line'>    <span class="n">r</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span>
</span><span class='line'>        <span class="s">&#39;http://de.wiktionary.org/w/api.php?&#39;</span> <span class="o">+</span>
</span><span class='line'>        <span class="s">&#39;format=json&#39;</span> <span class="o">+</span>
</span><span class='line'>        <span class="s">&#39;&amp;action=query&#39;</span> <span class="o">+</span>
</span><span class='line'>        <span class="s">&#39;&amp;prop=revisions&#39;</span> <span class="o">+</span>
</span><span class='line'>        <span class="s">&#39;&amp;rvprop=content&#39;</span> <span class="o">+</span>
</span><span class='line'>        <span class="s">&#39;&amp;titles=&#39;</span> <span class="o">+</span>
</span><span class='line'>        <span class="n">substantiv</span>
</span><span class='line'>        <span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class='line'><span class="k">except</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">URLError</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
</span><span class='line'>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&#39;Problem beim Zugriff auf Wiktionary.&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Wir basteln uns die API-Anfrage zusammen. Oben ist erklärt, wieso die Abfrage so aussieht, wie sie aussieht. Wenn die Abfrage über das Internet nicht klappen sollte, brechen wir hier ab.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">content</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</span><span class='line'><span class="n">page</span> <span class="o">=</span> <span class="n">content</span><span class="p">[</span><span class="s">&#39;query&#39;</span><span class="p">][</span><span class="s">&#39;pages&#39;</span><span class="p">][</span><span class="n">content</span><span class="p">[</span><span class="s">&#39;query&#39;</span><span class="p">][</span><span class="s">&#39;pages&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>
</span><span class='line'><span class="k">if</span> <span class="s">&#39;revisions&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">page</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span class='line'>        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span>
</span><span class='line'>            <span class="s">&#39;Substantiv nicht im deutschsprachigen Wiktionary verzeichnet.&#39;</span>
</span><span class='line'>        <span class="p">)</span>
</span><span class='line'><span class="n">wikitext</span> <span class="o">=</span> <span class="p">(</span><span class="n">page</span><span class="p">[</span><span class="s">&#39;revisions&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;*&#39;</span><span class="p">])</span>
</span></code></pre></td></tr></table></div></figure>


<p>Der Seiteninhalt wird als <code>JSON</code> eingelesen und in eine Python-Datenstruktur hineingeschlürft. Wenn es keine Seite mit dem Titel gibt, der gewünscht ist, brechen wir ab. <a href="http://blog.johl.io/blog/2013/10/20/autovivication/">Python kennt schließlich keine Autovivication bei Collections</a>, also passen wir auf wie ein Luchs, dass wir nicht auf eine Struktur zugreifen, für die es keinen Key gibt.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
</span><span class='line'>    <span class="s">&#39;===\s?,\s?&#39;</span> <span class="o">+</span>
</span><span class='line'>    <span class="s">&#39;&#39;</span> <span class="o">+</span>
</span><span class='line'>    <span class="s">&#39;(,\s?(,\s?)?)*&#39;</span> <span class="o">+</span>
</span><span class='line'>    <span class="s">&#39;\s?===&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="n">wikitext</span><span class="p">)</span>
</span><span class='line'><span class="k">if</span> <span class="n">match</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
</span><span class='line'>    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&#39;Kein Substantiv!&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Es folgt eine epische <em>regular expression</em>, mit der der <a href="https://de.wikipedia.org/wiki/Wikitext">Wikitext</a> geparst wird. Leider wird im Wiktionary nicht ganz durchgängig dasselbe Pattern für die Angabe des grammatischen Geschlechts genutzt. Aber irgendwie sowas wie &#8220;m&#8221; oder &#8220;mf&#8221; oder &#8220;m,f,n&#8221; steht hinter einer Template-Variable, die ein Substantiv bezeichnet. Wenn nicht mal dieses Pattern gefunden wird, ist der Suchstring wohl kein Substantiv und wir verabschieden uns aus dem Programm.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">genera</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s">&#39;^[mfn]$&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span>
</span><span class='line'>                <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()))</span>
</span></code></pre></td></tr></table></div></figure>


<p>Wir filtern aus den <em>capturing brackets</em> alles heraus, was nicht &#8220;m&#8221;, &#8220;f&#8221;, oder &#8220;n&#8221; ist. Ich finde da eine Lösung mit zwei Filtern (und anonymen Lambda-Funktionen) am elegantesten, aber das ist natürlich Geschmackssache.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">m</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;der &quot;</span> <span class="o">+</span> <span class="n">substantiv</span> <span class="k">for</span> <span class="n">genus</span> <span class="ow">in</span> <span class="n">genera</span> <span class="k">if</span> <span class="n">genus</span> <span class="o">==</span> <span class="s">&quot;m&quot;</span><span class="p">]</span>
</span><span class='line'><span class="n">f</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;die &quot;</span> <span class="o">+</span> <span class="n">substantiv</span> <span class="k">for</span> <span class="n">genus</span> <span class="ow">in</span> <span class="n">genera</span> <span class="k">if</span> <span class="n">genus</span> <span class="o">==</span> <span class="s">&quot;f&quot;</span><span class="p">]</span>
</span><span class='line'><span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;das &quot;</span> <span class="o">+</span> <span class="n">substantiv</span> <span class="k">for</span> <span class="n">genus</span> <span class="ow">in</span> <span class="n">genera</span> <span class="k">if</span> <span class="n">genus</span> <span class="o">==</span> <span class="s">&quot;n&quot;</span><span class="p">]</span>
</span><span class='line'><span class="n">artikel</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">f</span> <span class="o">+</span> <span class="n">n</span>
</span></code></pre></td></tr></table></div></figure>


<p>Mit ein paar <em>list comprehensions</em> bauen wir uns drei Listen mit den gefilterten Ergebnissen, die wir dann zu einer flachen Ergebnisliste vereinigen (<code>artikel</code>). Natürlich kann ein Substantiv mehr als ein grammtisches Geschlecht und damit mehr als einen gültigen Artikel haben.</p>

<p>Warum basteln wir uns eine Liste? Nun, darum:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="nb">map</span><span class="p">(</span><span class="k">print</span><span class="p">,</span> <span class="n">artikel</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Lieber ein gedingenes <code>map</code> auf eine Liste als eine <code>for</code>-Schleife. Da wir <code>print</code> als Funktion benutzen können (wir haben extra <code>from __future__ import print_function</code> benutzt), können wir diese Funktion auf alle möglichen Ergebnis-Strings anwenden.</p>

<p>Was gibt dieses Programm jetzt aus? Nun, schauen wir mal:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">python</span> <span class="n">migrationsschatten</span><span class="o">.</span><span class="n">py</span> <span class="n">Knoblauch</span>
</span><span class='line'><span class="n">der</span> <span class="n">Knoblauch</span>
</span></code></pre></td></tr></table></div></figure>


<p>oder auch:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">python</span> <span class="n">migrationsschatten</span><span class="o">.</span><span class="n">py</span> <span class="n">Ketchup</span>
</span><span class='line'><span class="n">der</span> <span class="n">Ketchup</span>
</span><span class='line'><span class="n">das</span> <span class="n">Ketchup</span>
</span></code></pre></td></tr></table></div></figure>


<p>oder gar:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">python</span> <span class="n">migrationsschatten</span><span class="o">.</span><span class="n">py</span> <span class="n">Joghurt</span>
</span><span class='line'><span class="n">der</span> <span class="n">Joghurt</span>
</span><span class='line'><span class="n">die</span> <span class="n">Joghurt</span>
</span><span class='line'><span class="n">das</span> <span class="n">Joghurt</span>
</span></code></pre></td></tr></table></div></figure>


<p>Und was ist mit der Frage aus der Überschrift?</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'> </span>
<span class='line-number'> </span>
<span class='line-number'> </span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">python</span> <span class="n">migrationsschatten</span><span class="o">.</span><span class="n">py</span> <span class="n">Cola</span>
</span><span class='line'><span class="n">die</span> <span class="n">Cola</span>
</span><span class='line'><span class="n">das</span> <span class="n">Cola</span>
</span></code></pre></td></tr></table></div></figure>


<p>So seltsam das für bundesdeutsche Sprecherinnen und Sprecher klingen mag, <strong>das</strong> Cola ist okay, sagt Wiktionary. Es handelt sich um einen <a href="https://de.wikipedia.org/wiki/Austriazismus">Austriazismus</a>.</p>

<p><a href="https://de.wiktionary.org/wiki/leiwand">Leiwand</a>!</p>

<p>Wie bereits gesagt, das vollständige Programm <a href="https://gist.github.com/johl/5515041">findet sich hier</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/16/links/">Links, Links, Links</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-11-16T13:06:00+01:00" pubdate>Nov 16<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="https://github.com/mapmeld/profanity65#profanity65">Encrypt your e-mail with PGP and random profanity</a></li>
<li><a href="http://learnlispthehardway.org/">Learn Lisp The Hard Way</a></li>
<li><a href="https://wwwwwwwwwwwwwwwwwwwwww.bitnik.org/r/">&#8220;The Random Darknet Shopper is an automated online shopping bot which we provide with a budget of $100 in Bitcoins per week. Once a week the bot goes on shopping spree in the deep web where it randomly choses and purchases one item and has it mailed to us.&#8221;</a></li>
<li><a href="http://www.washingtonpost.com/news/storyline/wp/2014/11/11/the-mathematician-who-proved-why-hipsters-all-look-alike/">The mathematician who proved why hipsters all look alike: What brain neurons tell us about the &#8216;hipster effect&#8217; when all contrarians end up looking the same</a></li>
<li><a href="http://openoil.net/2014/11/11/openoil-launches-repository-385-oil-contracts-from-54-countries-one-click-away/">OpenOil launches repository: 385 oil contracts from 54 countries, one click away</a></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/07/links/">Schnelle Links</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-11-07T12:55:00+01:00" pubdate>Nov 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://dangerousminds.net/comments/codex_seraphinianus_a_new_edition_of_the_strangest_book_in_the_world">Codex Seraphinianus: A new edition of the strangest book in the world</a></li>
<li><a href="http://chrishadfield.ca/space-oddity/">When David Bowie wrote and recorded Space Oddity in 1969, I wonder if he ever imagined it being played in orbit?</a></li>
<li><a href="https://en.wikipedia.org/wiki/How_does_one_patch_KDE2_under_FreeBSD%3F">&#8220;How does one patch KDE2 under FreeBSD?&#8221; (Russian: &#8220;Как пропатчить KDE2 под FreeBSD?&#8221;), an internet meme in Russian Internet culture</a></li>
<li><a href="http://blog.cryptographyengineering.com/2014/08/whats-matter-with-pgp.html">What&#8217;s the matter with PGP?</a></li>
<li><a href="http://pastebin.com/HrcErVWe">Pastebin: Recommendations for the Hacktivist Community</a> (via <a href="http://www.reddit.com/r/blackhat/comments/2ljjey/recommendations_for_the_hacktivist_community/">reddit</a>)</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/07/ethik/">Praktische Fragen der Ethik in der Software-Entwicklung</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-11-07T12:04:00+01:00" pubdate>Nov 7<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>It should be noted that no ethically-trained software engineer would ever consent to write a DestroyBaghdad procedure. Basic professional ethics would instead require him to write a DestroyCity procedure, to which Baghdad could be given as a parameter.</p><footer><strong>Nathaniel Borenstein</strong><cite><a href='http://www.guppylake.com/~nsb/CSCW-ATOMICMAIL.txt'>Computational Mail as Network Infrastructure for Computer-Supported Cooperative Work</a></cite></footer></blockquote>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/05/29/dinge/">Dinge</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-05-29T18:42:00+02:00" pubdate>May 29<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Einigen Dingen ist etwas einbeschrieben:</p>

<blockquote><p>Wie manchen Dingen Gesten, und damit Weisen des Verhaltens einbeschrieben sind. Pantoffel — »Schlappen«, Slippers — sind darauf berechnet, daß man ohne Hilfe der Hand mit den Füßen hineinschlüpft. Sie sind Denkmale des Hasses gegen das sich Bücken.</p><footer><strong>Theodor W. Adorno</strong><cite>Minima Moralia</cite></footer></blockquote>


<p>Andere Dinge hingegen werden durch kreativ-kritische Aneignung von dem Kontext befreit, in denen ihnen ein intendierter Zweck einbeschrieben ist.</p>

<p>Eine Dose mit Chips von <a href="http://www.oreillynet.com/cs/weblog/view/wlg/448">Pringels wird zur Wavelan-Yagi-Antenne</a> — auch wenn Pringels-Dosen sich gar nicht am besten für <a href="https://en.wikipedia.org/wiki/Cantenna">diesen Antennentyp</a> eignen.</p>

<p>Und eine <a href="https://en.wikipedia.org/wiki/Altoids">Dose mit Altoids-Mints</a> ist für mich dann kein Behälter für Minz-Bonbons mehr. In erster Linie sehe ich es es als <a href="http://tryingtodotheprojects.blogspot.de/2008/04/arduino-altoids-tin.html">Gehäuse für Arduino-Basteleien</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/03/19/probe/">Es tut sich was</a></h1>
    
    
      <p class="meta">
        




  

<time datetime="2014-03-19T13:31:00+01:00" pubdate>Mar 19<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Es passieren Sachen im <a href="http://www.c-base.org/projects/c-atre/">c-atre</a>, dem Science-Fiction-Theater in der <a href="https://de.wikipedia.org/wiki/C-base">c-base</a>. Stichworte: Urheberrecht, Zeitreisen. Im Mai wissen wir mehr.</p>

<p><img src="http://f.cl.ly/items/0u1E432E1E1w3x1H3L0A/probe.jpg"></p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/3/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <div>
  <img class="left" src="http://www.gravatar.com/avatar.php?size=100&gravatar_id=9de3f3969367fffe2051c2b405b79810">
  Das hier ist das Blog von <a href="http://www.johl.io">Jens Ohlig</a>. Es geht u.a. um: Programmierung, Basteln, Politik. Bisweilen sogar um Essen und Popkultur. Möglicherweise auch um völlig andere Themen.
  </div>
</section>
<section>
  <h1>Zuletzt geschrieben</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/12/23/bundestagsquartett/">Nebeneinkünftequartett der Bundestagsabgeordneten – Offene Karten mit offenen Daten</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/11/30/games/">Zwei akademische Papers zu Computerspielen und Daten aus Freiem Wissen</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/29/wikidata-cli/">Wikidata-Items schnell auf der Kommandozeile nachschlagen? Mediawiki APIs hacken</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/03/01/mischmasch/">Mischmasch</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/02/22/links/">Nachrichten aus der Zukunft</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Dankeschön</h1>
  <p>
  <a class="FlattrButton" style="display:none;" href="http://johl.github.com/"></a>
  <noscript><a href="http://flattr.com/thing/420157/Hackety-hack-hack-Atypisches-Nutzerverhalten-mit-Rat-und-Tat-" target="_blank">
  <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a></noscript>
  </p>
</section>

<section>
  <h1>Zuletzt getwittert</h1>
  <p>
  <a class="twitter-timeline" href="https://twitter.com/johl" data-widget-id="356792985440112640">Tweets by @johl</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </p>
</section>


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/113575664537952525641?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><div align="center">
  <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.de"><img alt="Creative Commons Lizenzvertrag" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png" /></a><br />Die Texte aller Artikel auf diesem Blog stehen unter einer <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.de">Creative Commons Namensnennung 3.0 Unported Lizenz</a>.
</div>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'blogityblogblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
